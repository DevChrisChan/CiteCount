<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Bank - CiteCount</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: var(--background-primary, #ffffff);
            color: var(--text-primary, #1f2937);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            body {
                background: var(--background-primary, #0f0f0f);
                color: var(--text-primary, #f3f4f6);
            }
            .word-title,
            .category-title,
            .word-item-title,
            .wordbank-footer,
            .no-results-title {
                color: var(--text-primary, #f3f4f6) !important;
            }
            .category-desc,
            .loading-text,
            .empty-state,
            .no-results-state,
            .word-meta,
            .example-label {
                color: var(--text-secondary, #a1a1aa) !important;
            }
            .word-card {
                background: var(--surface-color, #1f2937);
                border-color: var(--border-primary, #374151);
            }
            .word-card:hover {
                border-color: var(--accent-color, #60a5fa);
                background: var(--surface-hover, #252f3f);
            }
            .category-section {
                border-bottom-color: var(--border-primary, #374151);
            }
        }

        .wordbank-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
        }

        .search-section {
            padding: 1.5rem;
            background: var(--surface-color, #f9fafb);
            border-bottom: 1px solid var(--border-primary, #e5e7eb);
            flex-shrink: 0;
        }

        @media (prefers-color-scheme: dark) {
            .search-section {
                background: var(--surface-color, #1f2937);
                border-bottom-color: var(--border-primary, #374151);
            }
        }

        .search-input-wrapper {
            display: flex;
            gap: 0.75rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 0.75rem;
            background: var(--background-primary, #ffffff);
            color: var(--text-primary, #1f2937);
            border: 1px solid var(--border-primary, #e5e7eb);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        @media (prefers-color-scheme: dark) {
            .nav-btn {
                background: var(--background-primary, #0f0f0f);
                border-color: var(--border-primary, #374151);
            }
        }

        .nav-btn:hover:not(:disabled) {
            background: var(--surface-color, #f3f4f6);
            border-color: var(--accent-color, #1e40af);
        }

        @media (prefers-color-scheme: dark) {
            .nav-btn:hover:not(:disabled) {
                background: var(--surface-color, #1f2937);
            }
        }

        .nav-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .nav-btn svg {
            width: 20px;
            height: 20px;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 0.75rem 1rem;
            border: 1px solid var(--border-primary, #e5e7eb);
            border-radius: 0.5rem;
            font-size: 1rem;
            background: var(--background-primary, #ffffff);
            color: var(--text-primary, #1f2937);
            transition: all 0.2s ease;
        }

        @media (prefers-color-scheme: dark) {
            .search-input {
                background: var(--background-primary, #0f0f0f);
                color: var(--text-primary, #f3f4f6);
                border-color: var(--border-primary, #374151);
            }
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-color, #1e40af);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
        }

        .search-btn {
            padding: 0.75rem 1.5rem;
            background: var(--accent-color, #1e40af);
            color: white;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .search-btn:hover:not(:disabled) {
            background: #1e3a8a;
            transform: translateY(-1px);
        }

        .search-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .filter-tabs {
            display: flex;
            gap: 0.5rem;
            padding: 0 1.5rem 1rem 1.5rem;
            background: var(--surface-color, #f9fafb);
            overflow-x: auto;
            flex-shrink: 0;
        }

        @media (prefers-color-scheme: dark) {
            .filter-tabs {
                background: var(--surface-color, #1f2937);
            }
        }

        .filter-btn {
            padding: 0.5rem 1rem;
            background: transparent;
            color: var(--text-secondary, #6b7280);
            border: 1px solid var(--border-primary, #e5e7eb);
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
            white-space: nowrap;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        @media (prefers-color-scheme: dark) {
            .filter-btn {
                border-color: var(--border-primary, #374151);
            }
        }

        .filter-btn:hover {
            background: var(--surface-color, #f3f4f6);
            border-color: var(--accent-color, #1e40af);
        }

        @media (prefers-color-scheme: dark) {
            .filter-btn:hover {
                background: var(--surface-color, #252f3f);
            }
        }

        .filter-btn.active {
            background: var(--accent-color, #1e40af);
            color: white;
            border-color: var(--accent-color, #1e40af);
        }

        .content-section {
            flex: 1;
            overflow-y: auto;
            padding: 1.5rem;
        }

        .results-container {
            display: none;
            animation: slideIn 0.3s ease;
        }

        .results-container.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .category-section {
            margin-bottom: 2rem;
            border-bottom: 1px solid var(--border-primary, #e5e7eb);
            padding-bottom: 2rem;
        }

        .category-section:last-child {
            border-bottom: none;
        }

        .category-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
        }

        .category-icon {
            font-size: 1.75rem;
            flex-shrink: 0;
        }

        .category-info {
            flex: 1;
        }

        .category-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary, #1f2937);
            margin-bottom: 0.25rem;
        }

        .category-desc {
            font-size: 0.875rem;
            color: var(--text-secondary, #6b7280);
        }

        .words-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }

        .word-card {
            background: var(--surface-color, #f9fafb);
            border: 1px solid var(--border-primary, #e5e7eb);
            border-radius: 0.5rem;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        @media (prefers-color-scheme: dark) {
            .word-card {
                background: var(--surface-color, #1f2937);
                border-color: var(--border-primary, #374151);
            }
        }

        .word-card:hover {
            border-color: var(--accent-color, #1e40af);
            background: var(--surface-hover, #f3f4f6);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        @media (prefers-color-scheme: dark) {
            .word-card:hover {
                background: var(--surface-hover, #252f3f);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            }
        }

        .word-item-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary, #1f2937);
            margin-bottom: 0.25rem;
        }

        .word-meta {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-wrap: wrap;
            font-size: 0.85rem;
            color: var(--text-secondary, #6b7280);
        }

        .meta-badge {
            background: var(--background-primary, #f0f9ff);
            color: var(--accent-color, #1e40af);
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 500;
        }

        @media (prefers-color-scheme: dark) {
            .meta-badge {
                background: rgba(30, 64, 175, 0.2);
            }
        }

        .example-section {
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid var(--border-primary, #e5e7eb);
        }

        @media (prefers-color-scheme: dark) {
            .example-section {
                border-top-color: var(--border-primary, #374151);
            }
        }

        .example-label {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary, #6b7280);
            margin-bottom: 0.25rem;
        }

        .example-text {
            font-size: 0.875rem;
            color: var(--text-primary, #1f2937);
            font-style: italic;
            line-height: 1.4;
        }

        @media (prefers-color-scheme: dark) {
            .example-text {
                color: var(--text-primary, #f3f4f6);
            }
        }

        .loading-state {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .loading-state.active {
            display: block;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-primary, #e5e7eb);
            border-top-color: var(--accent-color, #1e40af);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .loading-text {
            color: var(--text-secondary, #6b7280);
            font-size: 0.95rem;
        }

        .empty-state {
            display: none;
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-secondary, #6b7280);
        }

        .empty-state.active {
            display: block;
        }

        .empty-state-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 1rem;
            opacity: 0.3;
        }

        .error-state {
            display: none;
            padding: 1.5rem;
            background: #fee2e2;
            border: 1px solid #fecaca;
            border-radius: 0.5rem;
            color: #dc2626;
            text-align: center;
        }

        @media (prefers-color-scheme: dark) {
            .error-state {
                background: #7f1d1d;
                border-color: #991b1b;
                color: #fecaca;
            }
        }

        .error-state.active {
            display: block;
        }

        .no-results-state {
            display: none;
            text-align: center;
            padding: 3rem 1rem;
            color: var(--text-secondary, #6b7280);
        }

        .no-results-state.active {
            display: block;
        }

        .no-results-icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 1rem;
            opacity: 0.3;
        }

        .no-results-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary, #1f2937);
            margin-bottom: 0.5rem;
        }

        .wordbank-footer {
            opacity: 0.8;
            color: var(--text-secondary, #6b7280);
            font-size: 0.9rem;
            line-height: 1.4;
            padding: 0.75rem 1rem;
            text-align: center;
            border-top: 1px solid var(--border-primary, #e5e7eb);
            flex-shrink: 0;
            background: transparent;
        }

        @media (prefers-color-scheme: dark) {
            .wordbank-footer {
                border-top-color: var(--border-primary, #374151);
            }
        }

        .wordbank-footer.hidden {
            display: none;
        }

        /* Modal shown when page is opened directly (not in an iframe) */
        .embed-modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.6);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            padding: 1rem;
        }

        .embed-modal-overlay.active {
            display: flex;
        }

        .embed-modal {
            max-width: 520px;
            width: 100%;
            background: var(--background-primary, #ffffff);
            color: var(--text-primary, #1f2937);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(2,6,23,0.25);
            padding: 1.25rem 1.25rem;
            text-align: left;
        }

        @media (prefers-color-scheme: dark) {
            .embed-modal {
                background: #0b1220;
                color: #f3f4f6;
            }
            .embed-modal-overlay {
                background: rgba(2,6,23,0.7);
            }
        }

        .embed-modal h3 {
            margin-bottom: 0.5rem;
            font-size: 1.125rem;
        }

        .embed-modal p {
            margin-bottom: 1rem;
            color: var(--text-secondary, #6b7280);
        }

        .embed-modal .modal-actions {
            display: flex;
            gap: 0.5rem;
            justify-content: flex-end;
        }

        .embed-modal .modal-btn {
            padding: 0.5rem 0.85rem;
            border-radius: 0.5rem;
            border: 1px solid transparent;
            cursor: pointer;
        }

        .embed-modal .modal-btn.primary {
            background: var(--accent-color, #1e40af);
            color: white;
            border-color: var(--accent-color, #1e40af);
        }

        .embed-modal .modal-btn.ghost {
            background: transparent;
            color: inherit;
            border-color: var(--border-primary, #e5e7eb);
        }

        @media (max-width: 268px) {
            .search-section {
                padding: 1rem;
            }

            .filter-tabs {
                padding: 0 1rem 0.75rem 1rem;
            }

            .content-section {
                padding: 1rem;
            }

            .search-input-wrapper {
                gap: 0.5rem;
            }

            .search-input {
                padding: 0.6rem 0.75rem;
                font-size: 0.95rem;
            }

            .search-btn {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }

            .category-title {
                font-size: 1.1rem;
            }

            .words-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .filter-tabs {
                flex-wrap: wrap;
            }

            .filter-btn {
                padding: 0.4rem 0.75rem;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="wordbank-container">
        <div class="search-section">
            <div class="search-input-wrapper">
                <button class="nav-btn" id="backBtn" onclick="navigateBack()" disabled title="Go back">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7"/>
                    </svg>
                </button>
                <button class="nav-btn" id="forwardBtn" onclick="navigateForward()" disabled title="Go forward">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </button>
                <input 
                    type="text" 
                    id="searchInput" 
                    class="search-input" 
                    placeholder="Search for transition words or phrases..." 
                    autocomplete="off"
                >
                <button class="search-btn" id="searchBtn" onclick="searchWords()">Search</button>
            </div>
        </div>

        <div class="filter-tabs" id="filterTabs"></div>

        <div class="content-section">
            <div class="loading-state" id="loadingState">
                <div class="spinner"></div>
                <div class="loading-text">Finding words...</div>
            </div>

            <div class="error-state" id="errorState"></div>

            <div class="empty-state active" id="emptyState">
                <svg class="empty-state-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M18,2 C19.3807,2 20.5,3.11929 20.5,4.5 L20.5,4.5 L20.5,18.75 C20.5,19.1642 20.1642,19.5 19.75,19.5 L19.75,19.5 L5.5,19.5 C5.5,20.0523 5.94772,20.5 6.5,20.5 L6.5,20.5 L19.75,20.5 C20.1642,20.5 20.5,20.8358 20.5,21.25 C20.5,21.6642 20.1642,22 19.75,22 L19.75,22 L6.5,22 C5.11929,22 4,20.8807 4,19.5 L4,19.5 L4,4.5 C4,3.11929 5.11929,2 6.5,2 L6.5,2 Z M16,5 L8,5 C7.44772,5 7,5.44772 7,6 L7,7 C7,7.55228 7.44772,8 8,8 L16,8 C16.5523,8 17,7.55228 17,7 L17,6 C17,5.44772 16.5523,5 16,5 Z"/>
                </svg>
                <p>Browse categories or search for transition words and academic phrases</p>
            </div>

            <div class="no-results-state" id="noResultsState">
                <svg class="no-results-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="M21 21l-4.35-4.35"/>
                    <line x1="11" y1="8" x2="11" y2="14"/>
                    <line x1="8" y1="11" x2="14" y2="11"/>
                </svg>
                <div class="no-results-title">No words found</div>
                <p>We couldn't find any words matching "<span id="searchedWord"></span>". Try a different search term.</p>
            </div>

            <div class="results-container" id="resultsContainer"></div>
        </div>

        <footer class="wordbank-footer" role="contentinfo">
            <p>¬© <span id="copyrightYear"></span> CiteCount. All rights reserved.</p>
            <p>Academic Writing Resource.</p>
        </footer>
    </div>

    <!-- Modal shown when page is opened directly (not in an iframe) -->
    <div id="iframeModalOverlay" class="embed-modal-overlay" role="dialog" aria-modal="true" aria-labelledby="iframeModalTitle" style="display:none">
        <div class="embed-modal" role="document">
            <h3 id="iframeModalTitle">Designed as an Exam Timer Tool</h3>
            <p>This word bank is intended to be used inside the exam timer app. For the best experience, open it from the exam timer interface.</p>
            <div class="modal-actions">
                <button id="iframeModalDismiss" class="modal-btn ghost">Dismiss</button>
            </div>
        </div>
    </div>

    <script>
        // Complete Word Bank Data
        const wordBankData = {
            transitions: [
                {
                    "category": "Addition",
                    "icon": "‚ûï",
                    "description": "Add supporting points or examples",
                    "type": "transition",
                    "words": [
                        { "word": "Additionally", "formality": "formal", "example": "Additionally, the study revealed..." },
                        { "word": "Furthermore", "formality": "formal", "example": "Furthermore, this suggests..." },
                        { "word": "Moreover", "formality": "formal", "example": "Moreover, recent evidence shows..." },
                        { "word": "In addition", "formality": "formal", "example": "In addition, researchers found..." },
                        { "word": "Also", "formality": "neutral", "example": "The data also indicates..." },
                        { "word": "Besides", "formality": "informal", "example": "Besides, other factors contribute..." },
                        { "word": "Equally important", "formality": "formal", "example": "Equally important is the role of..." },
                        { "word": "Not to mention", "formality": "informal", "example": "Not to mention the economic impact..." },
                        { "word": "As well as", "formality": "neutral", "example": "Economics as well as politics..." },
                        { "word": "Likewise", "formality": "formal", "example": "Likewise, historical patterns..." }
                    ]
                },
                {
                    "category": "Contrast",
                    "icon": "‚öñÔ∏è",
                    "description": "Show differences or opposing viewpoints",
                    "type": "transition",
                    "words": [
                        { "word": "However", "formality": "formal", "example": "However, critics argue that..." },
                        { "word": "Nevertheless", "formality": "formal", "example": "Nevertheless, the data suggests..." },
                        { "word": "Nonetheless", "formality": "formal", "example": "Nonetheless, there are limitations..." },
                        { "word": "On the other hand", "formality": "neutral", "example": "On the other hand, some researchers..." },
                        { "word": "Conversely", "formality": "formal", "example": "Conversely, the opposite trend..." },
                        { "word": "In contrast", "formality": "formal", "example": "In contrast, developing nations..." },
                        { "word": "Although", "formality": "neutral", "example": "Although this theory prevails..." },
                        { "word": "While", "formality": "neutral", "example": "While Smith argues..., Jones contends..." },
                        { "word": "Yet", "formality": "neutral", "example": "Yet significant challenges remain..." },
                        { "word": "Despite this", "formality": "formal", "example": "Despite this, evidence shows..." },
                        { "word": "Even so", "formality": "informal", "example": "Even so, the conclusion holds..." },
                        { "word": "Alternatively", "formality": "formal", "example": "Alternatively, one might consider..." }
                    ]
                },
                {
                    "category": "Cause & Effect",
                    "icon": "üîÑ",
                    "description": "Show relationships between events",
                    "type": "transition",
                    "words": [
                        { "word": "Consequently", "formality": "formal", "example": "Consequently, unemployment rose..." },
                        { "word": "Therefore", "formality": "formal", "example": "Therefore, the hypothesis is valid..." },
                        { "word": "Thus", "formality": "formal", "example": "Thus, we can conclude..." },
                        { "word": "As a result", "formality": "neutral", "example": "As a result, GDP declined..." },
                        { "word": "Hence", "formality": "formal", "example": "Hence, further research is needed..." },
                        { "word": "Accordingly", "formality": "formal", "example": "Accordingly, policy shifted..." },
                        { "word": "For this reason", "formality": "neutral", "example": "For this reason, the model fails..." },
                        { "word": "This leads to", "formality": "neutral", "example": "This leads to significant implications..." },
                        { "word": "Subsequently", "formality": "formal", "example": "Subsequently, rates increased..." },
                        { "word": "In turn", "formality": "neutral", "example": "This in turn affects..." },
                        { "word": "So", "formality": "informal", "example": "So the trend continues..." }
                    ]
                },
                {
                    "category": "Example",
                    "icon": "üí°",
                    "description": "Provide examples or evidence",
                    "type": "transition",
                    "words": [
                        { "word": "For example", "formality": "neutral", "example": "For example, Smith (2023) found..." },
                        { "word": "For instance", "formality": "formal", "example": "For instance, GDP growth..." },
                        { "word": "To illustrate", "formality": "formal", "example": "To illustrate this point..." },
                        { "word": "Specifically", "formality": "neutral", "example": "Specifically, unemployment rates..." },
                        { "word": "In particular", "formality": "formal", "example": "In particular, younger demographics..." },
                        { "word": "Such as", "formality": "neutral", "example": "...factors such as inflation..." },
                        { "word": "Namely", "formality": "formal", "example": "Three key issues, namely..." },
                        { "word": "As demonstrated by", "formality": "formal", "example": "As demonstrated by recent studies..." },
                        { "word": "As shown by", "formality": "neutral", "example": "As shown by the data..." },
                        { "word": "To demonstrate", "formality": "formal", "example": "To demonstrate, consider..." }
                    ]
                },
                {
                    "category": "Emphasis",
                    "icon": "‚ö†Ô∏è",
                    "description": "Stress important points",
                    "type": "transition",
                    "words": [
                        { "word": "Indeed", "formality": "formal", "example": "Indeed, this proves critical..." },
                        { "word": "Certainly", "formality": "neutral", "example": "Certainly, the evidence supports..." },
                        { "word": "Undoubtedly", "formality": "formal", "example": "Undoubtedly, this remains significant..." },
                        { "word": "Obviously", "formality": "informal", "example": "Obviously, inflation impacts..." },
                        { "word": "Clearly", "formality": "neutral", "example": "Clearly, the trend indicates..." },
                        { "word": "Notably", "formality": "formal", "example": "Notably, this study reveals..." },
                        { "word": "Significantly", "formality": "formal", "example": "Significantly, rates increased..." },
                        { "word": "Particularly", "formality": "formal", "example": "Particularly relevant is..." },
                        { "word": "Especially", "formality": "neutral", "example": "Especially in developing nations..." },
                        { "word": "Above all", "formality": "formal", "example": "Above all, this demonstrates..." },
                        { "word": "Most importantly", "formality": "neutral", "example": "Most importantly, data shows..." }
                    ]
                },
                {
                    "category": "Sequence",
                    "icon": "‚è∞",
                    "description": "Show order or timing of events",
                    "type": "transition",
                    "words": [
                        { "word": "First", "formality": "neutral", "example": "First, consider the evidence..." },
                        { "word": "Second", "formality": "neutral", "example": "Second, examine the implications..." },
                        { "word": "Subsequently", "formality": "formal", "example": "Subsequently, rates declined..." },
                        { "word": "Meanwhile", "formality": "neutral", "example": "Meanwhile, unemployment rose..." },
                        { "word": "Previously", "formality": "formal", "example": "Previously, scholars believed..." },
                        { "word": "Following this", "formality": "formal", "example": "Following this, policies changed..." },
                        { "word": "Initially", "formality": "formal", "example": "Initially, the hypothesis stated..." },
                        { "word": "Eventually", "formality": "neutral", "example": "Eventually, consensus emerged..." },
                        { "word": "Finally", "formality": "neutral", "example": "Finally, the study concludes..." },
                        { "word": "In the meantime", "formality": "neutral", "example": "In the meantime, trends shifted..." },
                        { "word": "Afterwards", "formality": "neutral", "example": "Afterwards, research expanded..." }
                    ]
                },
                {
                    "category": "Conclusion",
                    "icon": "üéØ",
                    "description": "Summarize or conclude arguments",
                    "type": "transition",
                    "words": [
                        { "word": "In conclusion", "formality": "formal", "example": "In conclusion, evidence supports..." },
                        { "word": "To conclude", "formality": "formal", "example": "To conclude, this analysis reveals..." },
                        { "word": "In summary", "formality": "formal", "example": "In summary, three factors emerge..." },
                        { "word": "To sum up", "formality": "neutral", "example": "To sum up, the data indicates..." },
                        { "word": "Overall", "formality": "neutral", "example": "Overall, trends suggest..." },
                        { "word": "In brief", "formality": "formal", "example": "In brief, the study demonstrates..." },
                        { "word": "Ultimately", "formality": "formal", "example": "Ultimately, this proves..." },
                        { "word": "In essence", "formality": "formal", "example": "In essence, the argument holds..." },
                        { "word": "All in all", "formality": "informal", "example": "All in all, results confirm..." },
                        { "word": "On the whole", "formality": "formal", "example": "On the whole, evidence shows..." },
                        { "word": "In short", "formality": "neutral", "example": "In short, the hypothesis fails..." }
                    ]
                },
                {
                    "category": "Comparison",
                    "icon": "üîó",
                    "description": "Show similarities between ideas",
                    "type": "transition",
                    "words": [
                        { "word": "Similarly", "formality": "formal", "example": "Similarly, Jones (2024) argues..." },
                        { "word": "Likewise", "formality": "formal", "example": "Likewise, economic factors..." },
                        { "word": "In the same way", "formality": "neutral", "example": "In the same way, historical data..." },
                        { "word": "Comparatively", "formality": "formal", "example": "Comparatively, rates increased..." },
                        { "word": "By comparison", "formality": "formal", "example": "By comparison, earlier studies..." },
                        { "word": "Just as", "formality": "neutral", "example": "Just as Smith noted..." },
                        { "word": "In a similar manner", "formality": "formal", "example": "In a similar manner, results show..." },
                        { "word": "Correspondingly", "formality": "formal", "example": "Correspondingly, unemployment..." },
                        { "word": "Equally", "formality": "formal", "example": "Equally, social factors..." }
                    ]
                }
            ],
            phrases: [
                {
                    "category": "Introducing",
                    "icon": "üìå",
                    "description": "Start your essay or introduce new sections",
                    "type": "phrase",
                    "items": [
                        { "phrase": "This essay examines...", "usage": "opening", "example": "This essay examines the economic impact of climate change." },
                        { "phrase": "This paper explores...", "usage": "opening", "example": "This paper explores the relationship between education and income inequality." },
                        { "phrase": "The purpose of this investigation is to...", "usage": "opening", "example": "The purpose of this investigation is to determine the effectiveness of..." },
                        { "phrase": "In recent years, there has been growing interest in...", "usage": "context", "example": "In recent years, there has been growing interest in renewable energy solutions." },
                        { "phrase": "One of the most significant debates in... concerns...", "usage": "context", "example": "One of the most significant debates in economics concerns wealth distribution." },
                        { "phrase": "The aim of this analysis is to...", "usage": "opening", "example": "The aim of this analysis is to evaluate the impact of social media on mental health." },
                        { "phrase": "This study seeks to...", "usage": "opening", "example": "This study seeks to understand the factors contributing to..." }
                    ]
                },
                {
                    "category": "Evidence",
                    "icon": "üìä",
                    "description": "Introduce data, studies, and research",
                    "type": "phrase",
                    "items": [
                        { "phrase": "According to [Author] (Year),", "usage": "citation", "example": "According to Smith (2023), global temperatures have risen significantly." },
                        { "phrase": "Research by [Author] suggests that...", "usage": "citation", "example": "Research by Jones suggests that early intervention improves outcomes." },
                        { "phrase": "The evidence indicates that...", "usage": "analysis", "example": "The evidence indicates that carbon emissions continue to rise." },
                        { "phrase": "Studies have shown that...", "usage": "general", "example": "Studies have shown that exercise improves cognitive function." },
                        { "phrase": "The data reveals that...", "usage": "analysis", "example": "The data reveals a strong correlation between poverty and crime rates." },
                        { "phrase": "Empirical evidence suggests...", "usage": "formal", "example": "Empirical evidence suggests a causal relationship between..." },
                        { "phrase": "As demonstrated by...", "usage": "citation", "example": "As demonstrated by recent clinical trials..." },
                        { "phrase": "This is supported by...", "usage": "reinforcement", "example": "This is supported by multiple peer-reviewed studies." }
                    ]
                },
                {
                    "category": "Analysis",
                    "icon": "üîç",
                    "description": "Analyze and interpret evidence",
                    "type": "phrase",
                    "items": [
                        { "phrase": "This suggests that...", "usage": "interpretation", "example": "This suggests that economic factors play a crucial role." },
                        { "phrase": "This implies that...", "usage": "interpretation", "example": "This implies that further research is necessary." },
                        { "phrase": "From this, we can infer that...", "usage": "interpretation", "example": "From this, we can infer that policy changes are needed." },
                        { "phrase": "The significance of this is...", "usage": "evaluation", "example": "The significance of this is that it challenges existing theories." },
                        { "phrase": "This can be explained by...", "usage": "interpretation", "example": "This can be explained by recent demographic shifts." },
                        { "phrase": "One possible explanation is...", "usage": "interpretation", "example": "One possible explanation is the lack of regulatory oversight." },
                        { "phrase": "It is evident that...", "usage": "conclusion", "example": "It is evident that climate patterns have shifted dramatically." },
                        { "phrase": "This demonstrates that...", "usage": "interpretation", "example": "This demonstrates that early intervention is effective." },
                        { "phrase": "What this means is...", "usage": "clarification", "example": "What this means is that the model requires refinement." },
                        { "phrase": "The data indicates that...", "usage": "analysis", "example": "The data indicates a strong positive correlation." },
                        { "phrase": "This raises the question of whether...", "usage": "critical thinking", "example": "This raises the question of whether current methods are sufficient." }
                    ]
                },
                {
                    "category": "Arguments",
                    "icon": "üí¨",
                    "description": "Present and develop your arguments",
                    "type": "phrase",
                    "items": [
                        { "phrase": "It can be argued that...", "usage": "presenting", "example": "It can be argued that globalization benefits developing nations." },
                        { "phrase": "There is considerable debate about...", "usage": "context", "example": "There is considerable debate about the effectiveness of this approach." },
                        { "phrase": "One argument in favor of... is that...", "usage": "supporting", "example": "One argument in favor of renewable energy is that it reduces carbon emissions." },
                        { "phrase": "The main argument is that...", "usage": "presenting", "example": "The main argument is that education reduces inequality." },
                        { "phrase": "This argument is supported by...", "usage": "reinforcement", "example": "This argument is supported by longitudinal studies." },
                        { "phrase": "A further point is that...", "usage": "addition", "example": "A further point is that technology accelerates change." },
                        { "phrase": "It is worth noting that...", "usage": "emphasis", "example": "It is worth noting that exceptions exist to this rule." },
                        { "phrase": "An additional consideration is...", "usage": "addition", "example": "An additional consideration is the environmental impact." }
                    ]
                },
                {
                    "category": "Comparison",
                    "icon": "‚öñÔ∏è",
                    "description": "Compare different ideas or perspectives",
                    "type": "phrase",
                    "items": [
                        { "phrase": "In comparison to...", "usage": "comparing", "example": "In comparison to traditional methods, this approach is more efficient." },
                        { "phrase": "Unlike...", "usage": "contrasting", "example": "Unlike previous studies, this research focuses on..." },
                        { "phrase": "In contrast to...", "usage": "contrasting", "example": "In contrast to Smith's findings, Jones argues that..." },
                        { "phrase": "Similarly...", "usage": "comparing", "example": "Similarly, recent data from Europe shows..." },
                        { "phrase": "While... on the other hand...", "usage": "contrasting", "example": "While developed nations prosper, on the other hand, developing nations struggle." },
                        { "phrase": "There are similarities between... and...", "usage": "comparing", "example": "There are similarities between the 2008 and 2020 economic crises." },
                        { "phrase": "The key difference is...", "usage": "contrasting", "example": "The key difference is the methodology employed." },
                        { "phrase": "Both... and... share...", "usage": "comparing", "example": "Both theories share a common foundation in behavioral economics." },
                        { "phrase": "Whereas... differs from... in that...", "usage": "contrasting", "example": "Whereas quantitative research differs from qualitative in that it uses numerical data." }
                    ]
                },
                {
                    "category": "Certainty",
                    "icon": "üéØ",
                    "description": "Express how certain you are about claims",
                    "type": "phrase",
                    "items": [
                        { "phrase": "It is certain that...", "usage": "high certainty", "example": "It is certain that climate change affects weather patterns." },
                        { "phrase": "It is likely that...", "usage": "moderate certainty", "example": "It is likely that inflation will continue to rise." },
                        { "phrase": "There is evidence to suggest that...", "usage": "moderate certainty", "example": "There is evidence to suggest that early education improves outcomes." },
                        { "phrase": "It seems probable that...", "usage": "moderate certainty", "example": "It seems probable that the trend will continue." },
                        { "phrase": "It is possible that...", "usage": "low certainty", "example": "It is possible that alternative explanations exist." },
                        { "phrase": "There is some doubt as to whether...", "usage": "uncertainty", "example": "There is some doubt as to whether this method is effective." },
                        { "phrase": "It remains unclear whether...", "usage": "uncertainty", "example": "It remains unclear whether these results can be replicated." },
                        { "phrase": "The evidence is inconclusive regarding...", "usage": "uncertainty", "example": "The evidence is inconclusive regarding long-term effects." },
                        { "phrase": "It is well established that...", "usage": "high certainty", "example": "It is well established that smoking causes cancer." },
                        { "phrase": "There is no doubt that...", "usage": "high certainty", "example": "There is no doubt that technology has transformed society." }
                    ]
                },
                {
                    "category": "Critique",
                    "icon": "üî¨",
                    "description": "Evaluate arguments and identify limitations",
                    "type": "phrase",
                    "items": [
                        { "phrase": "A limitation of this study is...", "usage": "critique", "example": "A limitation of this study is the small sample size." },
                        { "phrase": "One criticism of this approach is...", "usage": "critique", "example": "One criticism of this approach is its lack of empirical support." },
                        { "phrase": "However, this fails to account for...", "usage": "critique", "example": "However, this fails to account for cultural differences." },
                        { "phrase": "This argument is problematic because...", "usage": "critique", "example": "This argument is problematic because it relies on outdated assumptions." },
                        { "phrase": "Despite its merits, this theory has been criticized for...", "usage": "balanced critique", "example": "Despite its merits, this theory has been criticized for oversimplification." },
                        { "phrase": "The weakness of this approach is...", "usage": "critique", "example": "The weakness of this approach is its narrow focus." },
                        { "phrase": "Critics have pointed out that...", "usage": "critique", "example": "Critics have pointed out that the methodology is flawed." },
                        { "phrase": "This overlooks the fact that...", "usage": "critique", "example": "This overlooks the fact that economic factors vary regionally." },
                        { "phrase": "A potential issue with this is...", "usage": "critique", "example": "A potential issue with this is the lack of long-term data." },
                        { "phrase": "While this may be true, it ignores...", "usage": "critique", "example": "While this may be true, it ignores social determinants." }
                    ]
                },
                {
                    "category": "Causation",
                    "icon": "üîÑ",
                    "description": "Link causes to effects",
                    "type": "phrase",
                    "items": [
                        { "phrase": "This leads to...", "usage": "direct cause", "example": "This leads to increased unemployment rates." },
                        { "phrase": "As a consequence of...", "usage": "result", "example": "As a consequence of inflation, purchasing power declined." },
                        { "phrase": "This results in...", "usage": "direct cause", "example": "This results in significant economic disruption." },
                        { "phrase": "Due to...", "usage": "cause", "example": "Due to technological advances, productivity increased." },
                        { "phrase": "The effect of... is...", "usage": "effect", "example": "The effect of globalization is increased interdependence." },
                        { "phrase": "This can be attributed to...", "usage": "attribution", "example": "This can be attributed to policy changes in the 1990s." },
                        { "phrase": "The primary cause of... is...", "usage": "cause", "example": "The primary cause of inflation is excessive money supply." },
                        { "phrase": "This gives rise to...", "usage": "consequence", "example": "This gives rise to new challenges in governance." },
                        { "phrase": "One consequence of... is that...", "usage": "effect", "example": "One consequence of urbanization is that housing costs rise." }
                    ]
                },
                {
                    "category": "Opinion",
                    "icon": "üí≠",
                    "description": "State your position (use carefully in academic writing)",
                    "type": "phrase",
                    "items": [
                        { "phrase": "It could be argued that...", "usage": "tentative opinion", "example": "It could be argued that the benefits outweigh the costs." },
                        { "phrase": "From this perspective...", "usage": "framing", "example": "From this perspective, the policy appears successful." },
                        { "phrase": "It seems reasonable to suggest that...", "usage": "cautious opinion", "example": "It seems reasonable to suggest that reforms are needed." },
                        { "phrase": "This suggests that, arguably...", "usage": "hedged opinion", "example": "This suggests that, arguably, the current approach is flawed." },
                        { "phrase": "It might be said that...", "usage": "tentative", "example": "It might be said that the evidence is compelling." },
                        { "phrase": "One might conclude that...", "usage": "cautious conclusion", "example": "One might conclude that further research is warranted." },
                        { "phrase": "The evidence appears to support the view that...", "usage": "evidence-based opinion", "example": "The evidence appears to support the view that intervention is effective." }
                    ]
                },
                {
                    "category": "Concluding",
                    "icon": "üèÅ",
                    "description": "Summarize and conclude your argument",
                    "type": "phrase",
                    "items": [
                        { "phrase": "In conclusion, this essay has argued that...", "usage": "final summary", "example": "In conclusion, this essay has argued that education is fundamental to development." },
                        { "phrase": "To summarize, the main points are...", "usage": "summary", "example": "To summarize, the main points are economic stability and social equity." },
                        { "phrase": "This essay has examined...", "usage": "reflection", "example": "This essay has examined the relationship between poverty and crime." },
                        { "phrase": "The analysis has shown that...", "usage": "conclusion", "example": "The analysis has shown that significant disparities exist." },
                        { "phrase": "In light of this evidence...", "usage": "final judgment", "example": "In light of this evidence, policy reform appears necessary." },
                        { "phrase": "Taking all factors into consideration...", "usage": "balanced conclusion", "example": "Taking all factors into consideration, the benefits are substantial." },
                        { "phrase": "Overall, it can be concluded that...", "usage": "summary conclusion", "example": "Overall, it can be concluded that the hypothesis is supported." },
                        { "phrase": "The findings suggest that...", "usage": "research conclusion", "example": "The findings suggest that intervention strategies are effective." },
                        { "phrase": "In sum...", "usage": "brief summary", "example": "In sum, the evidence is compelling." },
                        { "phrase": "This investigation has revealed that...", "usage": "research conclusion", "example": "This investigation has revealed that systemic issues persist." }
                    ]
                }
            ]
        };

        // DOM Elements
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.getElementById('searchBtn');
        const loadingState = document.getElementById('loadingState');
        const errorState = document.getElementById('errorState');
        const emptyState = document.getElementById('emptyState');
        const noResultsState = document.getElementById('noResultsState');
        const resultsContainer = document.getElementById('resultsContainer');
        const backBtn = document.getElementById('backBtn');
        const forwardBtn = document.getElementById('forwardBtn');
        const footer = document.querySelector('.wordbank-footer');
        const filterTabs = document.getElementById('filterTabs');

        // Modal elements for iframe detection
        const iframeModalOverlay = document.getElementById('iframeModalOverlay');
        const iframeModalDismiss = document.getElementById('iframeModalDismiss');

        let currentFilter = 'all';

        // Initialize filter buttons
        function initializeFilters() {
            let html = '<button class="filter-btn active" data-filter="all" onclick="setFilter(\'all\')">All</button>';
            html += '<button class="filter-btn" data-filter="transitions" onclick="setFilter(\'transitions\')">Transitions</button>';
            html += '<button class="filter-btn" data-filter="phrases" onclick="setFilter(\'phrases\')">Phrases</button>';
            filterTabs.innerHTML = html;
        }

        function setFilter(filter) {
            currentFilter = filter;
            // Update active state
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.filter === filter);
            });
            // If we have search results, refilter them
            if (resultsContainer.classList.contains('active') && searchInput.value.trim()) {
                searchWords();
            } else {
                showAllCategories();
            }
        }

        function showIframeModal() {
            try {
                if (!iframeModalOverlay) return;
                if (localStorage && localStorage.getItem('wordbankModalDismissed') === '1') return;
                iframeModalOverlay.style.display = 'flex';
                requestAnimationFrame(() => iframeModalOverlay.classList.add('active'));
                document.body.style.overflow = 'hidden';
            } catch (e) {
                console.warn('Failed to show iframe modal', e);
            }
        }

        function hideIframeModal(persist = true) {
            try {
                if (!iframeModalOverlay) return;
                iframeModalOverlay.classList.remove('active');
                iframeModalOverlay.style.display = 'none';
                document.body.style.overflow = '';
                if (persist && localStorage) localStorage.setItem('wordbankModalDismissed', '1');
            } catch (e) {
                console.warn('Failed to hide iframe modal', e);
            }
        }

        if (iframeModalDismiss) {
            iframeModalDismiss.addEventListener('click', () => hideIframeModal(true));
        }

        if (iframeModalOverlay) {
            iframeModalOverlay.addEventListener('click', (ev) => {
                if (ev.target === iframeModalOverlay) hideIframeModal(true);
            });
        }

        // History management
        let searchHistory = [];
        let historyIndex = -1;

        // Handle Enter key in search input
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                searchWords();
            }
        });

        function updateNavigationButtons() {
            backBtn.disabled = historyIndex <= 0;
            forwardBtn.disabled = historyIndex >= searchHistory.length - 1;
        }

        function navigateBack() {
            if (historyIndex > 0) {
                historyIndex--;
                const term = searchHistory[historyIndex];
                searchInput.value = term;
                searchWords(true);
            }
        }

        function navigateForward() {
            if (historyIndex < searchHistory.length - 1) {
                historyIndex++;
                const term = searchHistory[historyIndex];
                searchInput.value = term;
                searchWords(true);
            }
        }

        function searchWords(isNavigation = false) {
            const term = searchInput.value.trim().toLowerCase();
            
            if (!term) {
                showAllCategories();
                return;
            }

            footer.classList.add('hidden');

            // Add to history
            if (!isNavigation) {
                if (historyIndex < searchHistory.length - 1) {
                    searchHistory = searchHistory.slice(0, historyIndex + 1);
                }
                if (searchHistory.length === 0 || searchHistory[searchHistory.length - 1] !== term) {
                    searchHistory.push(term);
                    historyIndex = searchHistory.length - 1;
                }
            }

            updateNavigationButtons();
            showLoadingState();

            // Simulate async search
            setTimeout(() => {
                performSearch(term);
            }, 300);
        }

        function performSearch(term) {
            let results = [];

            // Search in transitions
            if (currentFilter === 'all' || currentFilter === 'transitions') {
                wordBankData.transitions.forEach(category => {
                    const matching = category.words.filter(w => 
                        w.word.toLowerCase().includes(term) || 
                        w.example.toLowerCase().includes(term)
                    );
                    if (matching.length > 0) {
                        results.push({
                            ...category,
                            words: matching
                        });
                    }
                });
            }

            // Search in phrases
            if (currentFilter === 'all' || currentFilter === 'phrases') {
                wordBankData.phrases.forEach(category => {
                    const matching = category.items.filter(p => 
                        p.phrase.toLowerCase().includes(term) || 
                        p.example.toLowerCase().includes(term) ||
                        p.usage.toLowerCase().includes(term)
                    );
                    if (matching.length > 0) {
                        results.push({
                            ...category,
                            [category.type === 'phrase' ? 'items' : 'words']: matching
                        });
                    }
                });
            }

            if (results.length === 0) {
                showNoResults(term);
            } else {
                displaySearchResults(results, term);
            }
        }

        function showAllCategories() {
            hideAllStates();
            resultsContainer.classList.add('active');
            footer.classList.add('hidden');

            let html = '';

            const categoriesToShow = currentFilter === 'phrases' ? 
                wordBankData.phrases : 
                currentFilter === 'transitions' ? 
                wordBankData.transitions : 
                [...wordBankData.transitions, ...wordBankData.phrases];

            categoriesToShow.forEach(category => {
                html += buildCategoryHTML(category);
            });

            resultsContainer.innerHTML = html;
        }

        function displaySearchResults(results, searchTerm) {
            hideAllStates();
            resultsContainer.classList.add('active');

            let html = '';
            results.forEach(category => {
                html += buildCategoryHTML(category);
            });

            resultsContainer.innerHTML = html;
        }

        function buildCategoryHTML(category) {
            const items = category.type === 'phrase' ? category.items : category.words;
            if (!items || items.length === 0) return '';

            let html = `
                <div class="category-section">
                    <div class="category-header">
                        <div class="category-icon">${category.icon}</div>
                        <div class="category-info">
                            <div class="category-title">${category.category}</div>
                            <div class="category-desc">${category.description}</div>
                        </div>
                    </div>
                    <div class="words-grid">
            `;

            items.forEach(item => {
                const word = item.word || item.phrase;
                const formality = item.formality || item.usage || '';
                const example = item.example;

                html += `
                    <div class="word-card">
                        <div class="word-item-title">${word}</div>
                        <div class="word-meta">
                            <span class="meta-badge">${formality}</span>
                        </div>
                        <div class="example-section">
                            <div class="example-label">Example</div>
                            <div class="example-text">"${example}"</div>
                        </div>
                    </div>
                `;
            });

            html += `</div></div>`;
            return html;
        }

        function showLoadingState() {
            hideAllStates();
            loadingState.classList.add('active');
        }

        function showError(message) {
            hideAllStates();
            errorState.textContent = message;
            errorState.classList.add('active');
        }

        function showNoResults(term) {
            hideAllStates();
            document.getElementById('searchedWord').textContent = term;
            noResultsState.classList.add('active');
        }

        function hideAllStates() {
            loadingState.classList.remove('active');
            errorState.classList.remove('active');
            emptyState.classList.remove('active');
            noResultsState.classList.remove('active');
            resultsContainer.classList.remove('active');
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            searchInput.focus();
            const yElem = document.getElementById('copyrightYear');
            if (yElem) yElem.textContent = new Date().getFullYear();
            initializeFilters();
            showAllCategories();

            // Note: Modal detection disabled for embedded iframe usage in CiteCount
            // The component works best when embedded and doesn't need the standalone warning
        });
    </script>
</body>
</html>
